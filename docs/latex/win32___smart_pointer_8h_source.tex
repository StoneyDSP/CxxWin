\doxysection{win32\+\_\+\+Smart\+Pointer.\+h}
\hypertarget{win32___smart_pointer_8h_source}{}\label{win32___smart_pointer_8h_source}\index{include/CxxWin/modules/Win32\_core/memory/win32\_SmartPointer.h@{include/CxxWin/modules/Win32\_core/memory/win32\_SmartPointer.h}}
\mbox{\hyperlink{win32___smart_pointer_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#define\ \_\_WIN32\_SMARTPOINTER\_H\_\_}}
\DoxyCodeLine{00012\ }
\DoxyCodeLine{00018\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ ComClass>}
\DoxyCodeLine{00019\ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_smart_pointer}{SmartPointer}}}
\DoxyCodeLine{00020\ \{}
\DoxyCodeLine{00021\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00026\ \ \ \ \ \mbox{\hyperlink{class_smart_pointer_af23b718566d4beddf609e63d1f278459}{SmartPointer}}()\ noexcept\ \{\}}
\DoxyCodeLine{00032\ \ \ \ \ \mbox{\hyperlink{class_smart_pointer_a97fa335bc801171776f623bbb92b4757}{SmartPointer}}(ComClass*\ obj)\ :\ \mbox{\hyperlink{class_smart_pointer_aac6766043d71d6919260b32e3025f5ad}{ptr}}(obj)}
\DoxyCodeLine{00033\ \ \ \ \ \{}
\DoxyCodeLine{00034\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{class_smart_pointer_aac6766043d71d6919260b32e3025f5ad}{ptr}})}
\DoxyCodeLine{00035\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_smart_pointer_aac6766043d71d6919260b32e3025f5ad}{ptr}}-\/>AddRef();}
\DoxyCodeLine{00036\ \ \ \ \ \}}
\DoxyCodeLine{00042\ \ \ \ \ \mbox{\hyperlink{class_smart_pointer_a68ce3998e4b3ac9ffaca59064adfdb11}{SmartPointer}}(\mbox{\hyperlink{class_smart_pointer}{SmartPointer}}\&\ other)\ :\ \mbox{\hyperlink{class_smart_pointer_aac6766043d71d6919260b32e3025f5ad}{ptr}}(other.\mbox{\hyperlink{class_smart_pointer_aac6766043d71d6919260b32e3025f5ad}{ptr}})}
\DoxyCodeLine{00043\ \ \ \ \ \{}
\DoxyCodeLine{00044\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{class_smart_pointer_aac6766043d71d6919260b32e3025f5ad}{ptr}})}
\DoxyCodeLine{00045\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_smart_pointer_aac6766043d71d6919260b32e3025f5ad}{ptr}}-\/>AddRef();}
\DoxyCodeLine{00046\ \ \ \ \ \}}
\DoxyCodeLine{00051\ \ \ \ \ \mbox{\hyperlink{class_smart_pointer_a85bb3a40507619ca59672273ba90271d}{\string~SmartPointer}}()}
\DoxyCodeLine{00052\ \ \ \ \ \{}
\DoxyCodeLine{00053\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_smart_pointer_a2bfb0ebe9f8d89c4c3158e752e66737f}{release}}();}
\DoxyCodeLine{00054\ \ \ \ \ \}}
\DoxyCodeLine{00055\ }
\DoxyCodeLine{00061\ \ \ \ \ \textcolor{keyword}{operator}\ ComClass*()\ CONST\ \textcolor{keyword}{noexcept}}
\DoxyCodeLine{00062\ \ \ \ \ \{}
\DoxyCodeLine{00063\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{class_smart_pointer_aac6766043d71d6919260b32e3025f5ad}{ptr}};}
\DoxyCodeLine{00064\ \ \ \ \ \}}
\DoxyCodeLine{00065\ }
\DoxyCodeLine{00071\ \ \ \ \ ComClass\&\ \mbox{\hyperlink{class_smart_pointer_a684cf8a7fadb2431ef8486fe166537d9}{operator*}}()\ CONST\ noexcept}
\DoxyCodeLine{00072\ \ \ \ \ \{}
\DoxyCodeLine{00073\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ *\mbox{\hyperlink{class_smart_pointer_aac6766043d71d6919260b32e3025f5ad}{ptr}};}
\DoxyCodeLine{00074\ \ \ \ \ \}}
\DoxyCodeLine{00075\ }
\DoxyCodeLine{00081\ \ \ \ \ ComClass*\ \mbox{\hyperlink{class_smart_pointer_a01c7fb69b9c39d04e85e6990dd24c5e9}{operator-\/>}}()\ CONST\ noexcept}
\DoxyCodeLine{00082\ \ \ \ \ \{}
\DoxyCodeLine{00083\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{class_smart_pointer_aac6766043d71d6919260b32e3025f5ad}{ptr}};}
\DoxyCodeLine{00084\ \ \ \ \ \}}
\DoxyCodeLine{00085\ }
\DoxyCodeLine{00092\ \ \ \ \ \mbox{\hyperlink{class_smart_pointer}{SmartPointer}}\&\ \mbox{\hyperlink{class_smart_pointer_a4f673e8467aec54e7978e49b5f069861}{operator=\ }}(ComClass*\ \textcolor{keyword}{const}\ newPtr)}
\DoxyCodeLine{00093\ \ \ \ \ \{}
\DoxyCodeLine{00094\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (newPtr\ !=\ \textcolor{keyword}{nullptr})}
\DoxyCodeLine{00095\ \ \ \ \ \ \ \ \ \ \ \ \ newPtr-\/>AddRef();}
\DoxyCodeLine{00096\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_smart_pointer_a2bfb0ebe9f8d89c4c3158e752e66737f}{release}}();}
\DoxyCodeLine{00097\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_smart_pointer_aac6766043d71d6919260b32e3025f5ad}{ptr}}\ =\ newPtr;}
\DoxyCodeLine{00098\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{00099\ \ \ \ \ \}}
\DoxyCodeLine{00100\ }
\DoxyCodeLine{00107\ \ \ \ \ \mbox{\hyperlink{class_smart_pointer}{SmartPointer}}\&\ \mbox{\hyperlink{class_smart_pointer_a4f673e8467aec54e7978e49b5f069861}{operator=\ }}(\textcolor{keyword}{const}\ ComClass\&\ newPtr)}
\DoxyCodeLine{00108\ \ \ \ \ \{}
\DoxyCodeLine{00109\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{class_smart_pointer_a4f673e8467aec54e7978e49b5f069861}{operator=\ }}(newPtr.ptr);}
\DoxyCodeLine{00110\ \ \ \ \ \}}
\DoxyCodeLine{00111\ }
\DoxyCodeLine{00117\ \ \ \ \ ComClass**\ \mbox{\hyperlink{class_smart_pointer_a388d5622da034786e168895b1b936100}{resetAndGetAddress}}()}
\DoxyCodeLine{00118\ \ \ \ \ \{}
\DoxyCodeLine{00119\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_smart_pointer_a2bfb0ebe9f8d89c4c3158e752e66737f}{release}}();}
\DoxyCodeLine{00120\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_smart_pointer_aac6766043d71d6919260b32e3025f5ad}{ptr}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00121\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \&\mbox{\hyperlink{class_smart_pointer_aac6766043d71d6919260b32e3025f5ad}{ptr}};}
\DoxyCodeLine{00122\ \ \ \ \ \}}
\DoxyCodeLine{00123\ }
\DoxyCodeLine{00131\ \ \ \ \ HRESULT\ \mbox{\hyperlink{class_smart_pointer_a04517d2b42a71842cb23a24186a4c88e}{CoCreateInstance}}(REFCLSID\ classUUID,\ DWORD\ dwClsContext\ =\ CLSCTX\_INPROC\_SERVER)}
\DoxyCodeLine{00132\ \ \ \ \ \{}
\DoxyCodeLine{00133\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ This\ *must*\ call\ the\ global\ function,\ not\ the\ local.}}
\DoxyCodeLine{00134\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Consider\ overriding\ the\ return\ type\ def\ if\ any\ clashes...}}
\DoxyCodeLine{00135\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ (see\ JUCE\ Com\ Pointer)}}
\DoxyCodeLine{00136\ \ \ \ \ \ \ \ \ HRESULT\ hr\ =\ \mbox{\hyperlink{class_smart_pointer_a04517d2b42a71842cb23a24186a4c88e}{::CoCreateInstance}}(}
\DoxyCodeLine{00137\ \ \ \ \ \ \ \ \ \ \ \ \ classUUID,}
\DoxyCodeLine{00138\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{nullptr},}
\DoxyCodeLine{00139\ \ \ \ \ \ \ \ \ \ \ \ \ dwClsContext,}
\DoxyCodeLine{00140\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_uuidof(ComClass),}
\DoxyCodeLine{00141\ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{keywordtype}{void}**)\ \mbox{\hyperlink{class_smart_pointer_a388d5622da034786e168895b1b936100}{resetAndGetAddress}}()}
\DoxyCodeLine{00142\ \ \ \ \ \ \ \ \ );}
\DoxyCodeLine{00143\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ assert(hr\ !=\ CO\_E\_NOTINITIALIZED);}}
\DoxyCodeLine{00144\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ (hr\ !=\ CO\_E\_NOTINITIALIZED)\ ?\ hr\ :\ CO\_E\_NOTINITIALIZED;}
\DoxyCodeLine{00145\ \ \ \ \ \}}
\DoxyCodeLine{00146\ }
\DoxyCodeLine{00155\ \ \ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ otherComClass>}
\DoxyCodeLine{00156\ \ \ \ \ HRESULT\ \mbox{\hyperlink{class_smart_pointer_a4458f95c33d46be35a4ce0d3ed21be8d}{QueryInterface}}(REFCLSID\ classUUID,\ \mbox{\hyperlink{class_smart_pointer}{SmartPointer<otherComClass>}}\&\ destObj)\ CONST}
\DoxyCodeLine{00157\ \ \ \ \ \{}
\DoxyCodeLine{00158\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{class_smart_pointer_aac6766043d71d6919260b32e3025f5ad}{ptr}}\ ==\ \textcolor{keyword}{nullptr})}
\DoxyCodeLine{00159\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ E\_POINTER;}
\DoxyCodeLine{00160\ }
\DoxyCodeLine{00161\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{class_smart_pointer_aac6766043d71d6919260b32e3025f5ad}{ptr}}-\/>QueryInterface(classUUID,\ (\textcolor{keywordtype}{void}**)\ destObj.resetAndGetAddress());}
\DoxyCodeLine{00162\ \ \ \ \ \}}
\DoxyCodeLine{00163\ }
\DoxyCodeLine{00171\ \ \ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ otherComClass>}
\DoxyCodeLine{00172\ \ \ \ \ HRESULT\ \mbox{\hyperlink{class_smart_pointer_ae8195378156382f79c9cbd10b18f961d}{QueryInterface}}\ (\mbox{\hyperlink{class_smart_pointer}{SmartPointer<otherComClass>}}\&\ destObj)\ CONST}
\DoxyCodeLine{00173\ \ \ \ \ \{}
\DoxyCodeLine{00174\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ this-\/>\mbox{\hyperlink{class_smart_pointer_a4458f95c33d46be35a4ce0d3ed21be8d}{QueryInterface}}(\_\_uuidof(otherComClass),\ destObj);}
\DoxyCodeLine{00175\ \ \ \ \ \}}
\DoxyCodeLine{00176\ }
\DoxyCodeLine{00183\ \ \ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ otherComClass>}
\DoxyCodeLine{00184\ \ \ \ \ \mbox{\hyperlink{class_smart_pointer}{SmartPointer<otherComClass>}}\ \mbox{\hyperlink{class_smart_pointer_a698ca40a80fd57a62e769371505f2c78}{getInterface}}()\ CONST}
\DoxyCodeLine{00185\ \ \ \ \ \{}
\DoxyCodeLine{00186\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_smart_pointer}{SmartPointer<otherComClass>}}\ destObj;}
\DoxyCodeLine{00187\ }
\DoxyCodeLine{00188\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{class_smart_pointer_a4458f95c33d46be35a4ce0d3ed21be8d}{QueryInterface}}(destObj)\ ==\ S\_OK)}
\DoxyCodeLine{00189\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ destObj;}
\DoxyCodeLine{00190\ }
\DoxyCodeLine{00191\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00192\ \ \ \ \ \}}
\DoxyCodeLine{00193\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00194\ }
\DoxyCodeLine{00200\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_smart_pointer_a2bfb0ebe9f8d89c4c3158e752e66737f}{release}}()}
\DoxyCodeLine{00201\ \ \ \ \ \{}
\DoxyCodeLine{00202\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{class_smart_pointer_aac6766043d71d6919260b32e3025f5ad}{ptr}}\ !=\ \textcolor{keyword}{nullptr})\ \mbox{\hyperlink{class_smart_pointer_aac6766043d71d6919260b32e3025f5ad}{ptr}}-\/>Release();}
\DoxyCodeLine{00203\ \ \ \ \ \}}
\DoxyCodeLine{00204\ }
\DoxyCodeLine{00210\ \ \ \ \ ComClass**\ \mbox{\hyperlink{class_smart_pointer_a9e700118998b3b6740c5cadbc38123d2}{operator\&}}()\ noexcept\ \{\textcolor{comment}{/*\ (innaccessible)\ */}\}}
\DoxyCodeLine{00211\ }
\DoxyCodeLine{00213\ \ \ \ \ ComClass*\ \mbox{\hyperlink{class_smart_pointer_aac6766043d71d6919260b32e3025f5ad}{ptr}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00214\ \};}
\DoxyCodeLine{00215\ }
\DoxyCodeLine{00222\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class\ }First,\ \textcolor{keyword}{class}...\ ComClasses>}
\DoxyCodeLine{00223\ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_smart_pointer_helper_base}{SmartPointerHelperBase}}\ :\ \textcolor{keyword}{public}\ First,\ \textcolor{keyword}{public}\ ComClasses...}
\DoxyCodeLine{00224\ \{}
\DoxyCodeLine{00225\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00231\ \ \ \ \ \mbox{\hyperlink{class_smart_pointer_helper_base_ac76861e9458ab17c981b2b76f5890321}{SmartPointerHelperBase}}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ initRef)\ :\ \mbox{\hyperlink{class_smart_pointer_helper_base_ad2bc91bd39ccd269a3eec9cdcce0f8cf}{refCount}}(initRef)\ \{\}}
\DoxyCodeLine{00236\ \ \ \ \ \textcolor{keyword}{virtual}\ \mbox{\hyperlink{class_smart_pointer_helper_base_aef037e04d1a2ee08824b405b077d4b09}{\string~SmartPointerHelperBase}}()\ =\ \textcolor{keywordflow}{default};}
\DoxyCodeLine{00237\ }
\DoxyCodeLine{00243\ \ \ \ \ ULONG\ STDMETHODCALLTYPE\ \mbox{\hyperlink{class_smart_pointer_helper_base_a2c9426410eeb136beba8123b5d84dc6e}{AddRef}}()}
\DoxyCodeLine{00244\ \ \ \ \ \{}
\DoxyCodeLine{00245\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ ++\mbox{\hyperlink{class_smart_pointer_helper_base_ad2bc91bd39ccd269a3eec9cdcce0f8cf}{refCount}};}
\DoxyCodeLine{00246\ \ \ \ \ \}}
\DoxyCodeLine{00252\ \ \ \ \ ULONG\ STDMETHODCALLTYPE\ \mbox{\hyperlink{class_smart_pointer_helper_base_a3d16d242d337b87ad0a447ce8d6a7ecb}{Release}}()}
\DoxyCodeLine{00253\ \ \ \ \ \{}
\DoxyCodeLine{00254\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ r\ =\ -\/-\/\mbox{\hyperlink{class_smart_pointer_helper_base_ad2bc91bd39ccd269a3eec9cdcce0f8cf}{refCount}};}
\DoxyCodeLine{00255\ }
\DoxyCodeLine{00256\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (r\ ==\ 0)}
\DoxyCodeLine{00257\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{delete}\ \textcolor{keyword}{this};}
\DoxyCodeLine{00258\ }
\DoxyCodeLine{00259\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ r;}
\DoxyCodeLine{00260\ \ \ \ \ \}}
\DoxyCodeLine{00261\ }
\DoxyCodeLine{00262\ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00263\ }
\DoxyCodeLine{00268\ \ \ \ \ ULONG\ \mbox{\hyperlink{class_smart_pointer_helper_base_ad2bc91bd39ccd269a3eec9cdcce0f8cf}{refCount}};}
\DoxyCodeLine{00269\ }
\DoxyCodeLine{00280\ \ \ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ Type>}
\DoxyCodeLine{00281\ \ \ \ \ HRESULT\ STDMETHODCALLTYPE\ \mbox{\hyperlink{class_smart_pointer_helper_base_accdc2a95363ae4f3e76d5dc00e8fef38}{castToType}}(\textcolor{keywordtype}{void}**\ result)}
\DoxyCodeLine{00282\ \ \ \ \ \{}
\DoxyCodeLine{00283\ \ \ \ \ \ \ \ \ this-\/>\mbox{\hyperlink{class_smart_pointer_helper_base_a2c9426410eeb136beba8123b5d84dc6e}{AddRef}}();}
\DoxyCodeLine{00284\ \ \ \ \ \ \ \ \ *result\ =\ \textcolor{keyword}{dynamic\_cast<}Type*\textcolor{keyword}{>}(\textcolor{keyword}{this});}
\DoxyCodeLine{00285\ }
\DoxyCodeLine{00286\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ S\_OK;}
\DoxyCodeLine{00287\ \ \ \ \ \}}
\DoxyCodeLine{00288\ }
\DoxyCodeLine{00296\ \ \ \ \ HRESULT\ STDMETHODCALLTYPE\ \mbox{\hyperlink{class_smart_pointer_helper_base_af53910e1f9f795cd1016ff8cef9798af}{QueryInterface}}(REFIID\ refId,\ \textcolor{keywordtype}{void}**\ result)}
\DoxyCodeLine{00297\ \ \ \ \ \{}
\DoxyCodeLine{00298\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (refId\ ==\ \_\_uuidof\ (IUnknown))}
\DoxyCodeLine{00299\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ castToType<First>\ (result);}
\DoxyCodeLine{00300\ }
\DoxyCodeLine{00301\ \ \ \ \ \ \ \ \ *result\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00302\ }
\DoxyCodeLine{00303\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ E\_NOINTERFACE;}
\DoxyCodeLine{00304\ \ \ \ \ \}}
\DoxyCodeLine{00305\ \};}
\DoxyCodeLine{00306\ }
\DoxyCodeLine{00307\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}...\ ComClasses>}
\DoxyCodeLine{00308\ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_smart_pointer_helper}{SmartPointerHelper}}\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{class_smart_pointer_helper_base}{SmartPointerHelperBase}}<ComClasses...>}
\DoxyCodeLine{00309\ \{}
\DoxyCodeLine{00310\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00311\ \ \ \ \ \textcolor{keyword}{explicit}\ \mbox{\hyperlink{class_smart_pointer_helper}{SmartPointerHelper}}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ initRef\ =\ 1)\ :\ \mbox{\hyperlink{class_smart_pointer_helper_base}{SmartPointerHelperBase}}<ComClasses...>(initRef)\ \{\}}
\DoxyCodeLine{00312\ }
\DoxyCodeLine{00320\ \ \ \ \ HRESULT\ STDMETHODCALLTYPE\ \mbox{\hyperlink{class_smart_pointer_helper_ac41955be7a9eddf7a087305d7e20f08a}{QueryInterface}}(REFIID\ refId,\ \textcolor{keywordtype}{void}**\ result)}
\DoxyCodeLine{00321\ \ \ \ \ \{}
\DoxyCodeLine{00322\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::tuple<IID,\ void*>\ bases[]}
\DoxyCodeLine{00323\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00324\ \ \ \ \ \ \ \ \ \ \ \ \ std::make\_tuple\ (\_\_uuidof(ComClasses),\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{void}*\textcolor{keyword}{>}\ (\textcolor{keyword}{static\_cast<}ComClasses*\textcolor{keyword}{>}\ (\textcolor{keyword}{this})))...}
\DoxyCodeLine{00325\ \ \ \ \ \ \ \ \ \};}
\DoxyCodeLine{00326\ }
\DoxyCodeLine{00327\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Query\ a\ ranged\ 'for'\ loop\ (each\ 'base'\ in\ the\ 'bases'\ tuple\ array)}}
\DoxyCodeLine{00328\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ base\ :\ bases)}
\DoxyCodeLine{00329\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00330\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (refId\ ==\ std::get<0>\ (base))}
\DoxyCodeLine{00331\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00332\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>\mbox{\hyperlink{class_smart_pointer_helper_base_a2c9426410eeb136beba8123b5d84dc6e}{AddRef}}();}
\DoxyCodeLine{00333\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *result\ =\ std::get<1>\ (base);}
\DoxyCodeLine{00334\ }
\DoxyCodeLine{00335\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ S\_OK;}
\DoxyCodeLine{00336\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00337\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00338\ }
\DoxyCodeLine{00339\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{class_smart_pointer_helper_base_af53910e1f9f795cd1016ff8cef9798af}{SmartPointerHelperBase<ComClasses...>::QueryInterface}}\ (refId,\ result);}
\DoxyCodeLine{00340\ \ \ \ \ \}}
\DoxyCodeLine{00341\ \};}
\DoxyCodeLine{00342\ }
\DoxyCodeLine{00349\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ ComClass>}
\DoxyCodeLine{00350\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{win32___smart_pointer_8h_a53522409e1312cfaf53cebc29bff8008}{SafeRelease}}(ComClass**\ ptr)}
\DoxyCodeLine{00351\ \{}
\DoxyCodeLine{00352\ \ \ \ \ \textcolor{keywordflow}{if}\ (*ptr)}
\DoxyCodeLine{00353\ \ \ \ \ \{}
\DoxyCodeLine{00354\ \ \ \ \ \ \ \ \ (*ptr)-\/>Release();}
\DoxyCodeLine{00355\ \ \ \ \ \ \ \ \ *ptr\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00356\ \ \ \ \ \}}
\DoxyCodeLine{00357\ \}}

\end{DoxyCode}

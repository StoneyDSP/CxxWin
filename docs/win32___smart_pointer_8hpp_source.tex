\doxysection{win32\+\_\+\+Smart\+Pointer.\+hpp}
\hypertarget{win32___smart_pointer_8hpp_source}{}\label{win32___smart_pointer_8hpp_source}\index{include/CxxWin/modules/Win32\_core/memory/win32\_SmartPointer.hpp@{include/CxxWin/modules/Win32\_core/memory/win32\_SmartPointer.hpp}}
\mbox{\hyperlink{win32___smart_pointer_8hpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00027\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00029\ \textcolor{preprocessor}{\#define\ \_WIN32\_SMARTPOINTER\_HPP\_}}
\DoxyCodeLine{00030\ }
\DoxyCodeLine{00036\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ ComClass>}
\DoxyCodeLine{00037\ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_smart_pointer}{SmartPointer}}}
\DoxyCodeLine{00038\ \{}
\DoxyCodeLine{00039\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00044\ \ \ \ \ \mbox{\hyperlink{class_smart_pointer_af23b718566d4beddf609e63d1f278459}{SmartPointer}}()\ noexcept\ \{\}}
\DoxyCodeLine{00050\ \ \ \ \ \mbox{\hyperlink{class_smart_pointer_a97fa335bc801171776f623bbb92b4757}{SmartPointer}}(ComClass*\ obj)\ :\ \mbox{\hyperlink{class_smart_pointer_aac6766043d71d6919260b32e3025f5ad}{ptr}}(obj)}
\DoxyCodeLine{00051\ \ \ \ \ \{}
\DoxyCodeLine{00052\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{class_smart_pointer_aac6766043d71d6919260b32e3025f5ad}{ptr}})}
\DoxyCodeLine{00053\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_smart_pointer_aac6766043d71d6919260b32e3025f5ad}{ptr}}-\/>AddRef();}
\DoxyCodeLine{00054\ \ \ \ \ \}}
\DoxyCodeLine{00060\ \ \ \ \ \mbox{\hyperlink{class_smart_pointer_a68ce3998e4b3ac9ffaca59064adfdb11}{SmartPointer}}(\mbox{\hyperlink{class_smart_pointer}{SmartPointer}}\&\ other)\ :\ \mbox{\hyperlink{class_smart_pointer_aac6766043d71d6919260b32e3025f5ad}{ptr}}(other.\mbox{\hyperlink{class_smart_pointer_aac6766043d71d6919260b32e3025f5ad}{ptr}})}
\DoxyCodeLine{00061\ \ \ \ \ \{}
\DoxyCodeLine{00062\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{class_smart_pointer_aac6766043d71d6919260b32e3025f5ad}{ptr}})}
\DoxyCodeLine{00063\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_smart_pointer_aac6766043d71d6919260b32e3025f5ad}{ptr}}-\/>AddRef();}
\DoxyCodeLine{00064\ \ \ \ \ \}}
\DoxyCodeLine{00069\ \ \ \ \ \mbox{\hyperlink{class_smart_pointer_a85bb3a40507619ca59672273ba90271d}{\string~SmartPointer}}()}
\DoxyCodeLine{00070\ \ \ \ \ \{}
\DoxyCodeLine{00071\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_smart_pointer_a2bfb0ebe9f8d89c4c3158e752e66737f}{release}}();}
\DoxyCodeLine{00072\ \ \ \ \ \}}
\DoxyCodeLine{00073\ }
\DoxyCodeLine{00079\ \ \ \ \ \textcolor{keyword}{operator}\ ComClass*()\ CONST\ \textcolor{keyword}{noexcept}}
\DoxyCodeLine{00080\ \ \ \ \ \{}
\DoxyCodeLine{00081\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{class_smart_pointer_aac6766043d71d6919260b32e3025f5ad}{ptr}};}
\DoxyCodeLine{00082\ \ \ \ \ \}}
\DoxyCodeLine{00083\ }
\DoxyCodeLine{00089\ \ \ \ \ ComClass\&\ \mbox{\hyperlink{class_smart_pointer_a684cf8a7fadb2431ef8486fe166537d9}{operator*}}()\ CONST\ noexcept}
\DoxyCodeLine{00090\ \ \ \ \ \{}
\DoxyCodeLine{00091\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ *\mbox{\hyperlink{class_smart_pointer_aac6766043d71d6919260b32e3025f5ad}{ptr}};}
\DoxyCodeLine{00092\ \ \ \ \ \}}
\DoxyCodeLine{00093\ }
\DoxyCodeLine{00099\ \ \ \ \ ComClass*\ \mbox{\hyperlink{class_smart_pointer_a01c7fb69b9c39d04e85e6990dd24c5e9}{operator-\/>}}()\ CONST\ noexcept}
\DoxyCodeLine{00100\ \ \ \ \ \{}
\DoxyCodeLine{00101\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{class_smart_pointer_aac6766043d71d6919260b32e3025f5ad}{ptr}};}
\DoxyCodeLine{00102\ \ \ \ \ \}}
\DoxyCodeLine{00103\ }
\DoxyCodeLine{00110\ \ \ \ \ \mbox{\hyperlink{class_smart_pointer}{SmartPointer}}\&\ \mbox{\hyperlink{class_smart_pointer_a4f673e8467aec54e7978e49b5f069861}{operator=\ }}(ComClass*\ \textcolor{keyword}{const}\ newPtr)}
\DoxyCodeLine{00111\ \ \ \ \ \{}
\DoxyCodeLine{00112\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (newPtr\ !=\ \textcolor{keyword}{nullptr})}
\DoxyCodeLine{00113\ \ \ \ \ \ \ \ \ \ \ \ \ newPtr-\/>AddRef();}
\DoxyCodeLine{00114\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_smart_pointer_a2bfb0ebe9f8d89c4c3158e752e66737f}{release}}();}
\DoxyCodeLine{00115\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_smart_pointer_aac6766043d71d6919260b32e3025f5ad}{ptr}}\ =\ newPtr;}
\DoxyCodeLine{00116\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{00117\ \ \ \ \ \}}
\DoxyCodeLine{00118\ }
\DoxyCodeLine{00125\ \ \ \ \ \mbox{\hyperlink{class_smart_pointer}{SmartPointer}}\&\ \mbox{\hyperlink{class_smart_pointer_a4f673e8467aec54e7978e49b5f069861}{operator=\ }}(\textcolor{keyword}{const}\ ComClass\&\ newPtr)}
\DoxyCodeLine{00126\ \ \ \ \ \{}
\DoxyCodeLine{00127\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{class_smart_pointer_a4f673e8467aec54e7978e49b5f069861}{operator=\ }}(newPtr.ptr);}
\DoxyCodeLine{00128\ \ \ \ \ \}}
\DoxyCodeLine{00129\ }
\DoxyCodeLine{00135\ \ \ \ \ ComClass**\ \mbox{\hyperlink{class_smart_pointer_a388d5622da034786e168895b1b936100}{resetAndGetAddress}}()}
\DoxyCodeLine{00136\ \ \ \ \ \{}
\DoxyCodeLine{00137\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_smart_pointer_a2bfb0ebe9f8d89c4c3158e752e66737f}{release}}();}
\DoxyCodeLine{00138\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_smart_pointer_aac6766043d71d6919260b32e3025f5ad}{ptr}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00139\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \&\mbox{\hyperlink{class_smart_pointer_aac6766043d71d6919260b32e3025f5ad}{ptr}};}
\DoxyCodeLine{00140\ \ \ \ \ \}}
\DoxyCodeLine{00141\ }
\DoxyCodeLine{00149\ \ \ \ \ HRESULT\ \mbox{\hyperlink{class_smart_pointer_a04517d2b42a71842cb23a24186a4c88e}{CoCreateInstance}}(REFCLSID\ classUUID,\ DWORD\ dwClsContext\ =\ CLSCTX\_INPROC\_SERVER)}
\DoxyCodeLine{00150\ \ \ \ \ \{}
\DoxyCodeLine{00151\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ This\ *must*\ call\ the\ global\ function,\ not\ the\ local.}}
\DoxyCodeLine{00152\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Consider\ overriding\ the\ return\ type\ def\ if\ any\ clashes...}}
\DoxyCodeLine{00153\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ (see\ JUCE\ Com\ Pointer)}}
\DoxyCodeLine{00154\ \ \ \ \ \ \ \ \ HRESULT\ hr\ =\ \mbox{\hyperlink{class_smart_pointer_a04517d2b42a71842cb23a24186a4c88e}{::CoCreateInstance}}(}
\DoxyCodeLine{00155\ \ \ \ \ \ \ \ \ \ \ \ \ classUUID,}
\DoxyCodeLine{00156\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{nullptr},}
\DoxyCodeLine{00157\ \ \ \ \ \ \ \ \ \ \ \ \ dwClsContext,}
\DoxyCodeLine{00158\ \ \ \ \ \ \ \ \ \ \ \ \ \_\_uuidof(ComClass),}
\DoxyCodeLine{00159\ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{keywordtype}{void}**)\ \mbox{\hyperlink{class_smart_pointer_a388d5622da034786e168895b1b936100}{resetAndGetAddress}}()}
\DoxyCodeLine{00160\ \ \ \ \ \ \ \ \ );}
\DoxyCodeLine{00161\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ assert(hr\ !=\ CO\_E\_NOTINITIALIZED);}}
\DoxyCodeLine{00162\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ (hr\ !=\ CO\_E\_NOTINITIALIZED)\ ?\ hr\ :\ CO\_E\_NOTINITIALIZED;}
\DoxyCodeLine{00163\ \ \ \ \ \}}
\DoxyCodeLine{00164\ }
\DoxyCodeLine{00173\ \ \ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ otherComClass>}
\DoxyCodeLine{00174\ \ \ \ \ HRESULT\ \mbox{\hyperlink{class_smart_pointer_a4458f95c33d46be35a4ce0d3ed21be8d}{QueryInterface}}(REFCLSID\ classUUID,\ \mbox{\hyperlink{class_smart_pointer}{SmartPointer<otherComClass>}}\&\ destObj)\ CONST}
\DoxyCodeLine{00175\ \ \ \ \ \{}
\DoxyCodeLine{00176\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{class_smart_pointer_aac6766043d71d6919260b32e3025f5ad}{ptr}}\ ==\ \textcolor{keyword}{nullptr})}
\DoxyCodeLine{00177\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ E\_POINTER;}
\DoxyCodeLine{00178\ }
\DoxyCodeLine{00179\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{class_smart_pointer_aac6766043d71d6919260b32e3025f5ad}{ptr}}-\/>QueryInterface(classUUID,\ (\textcolor{keywordtype}{void}**)\ destObj.resetAndGetAddress());}
\DoxyCodeLine{00180\ \ \ \ \ \}}
\DoxyCodeLine{00181\ }
\DoxyCodeLine{00189\ \ \ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ otherComClass>}
\DoxyCodeLine{00190\ \ \ \ \ HRESULT\ \mbox{\hyperlink{class_smart_pointer_ae8195378156382f79c9cbd10b18f961d}{QueryInterface}}\ (\mbox{\hyperlink{class_smart_pointer}{SmartPointer<otherComClass>}}\&\ destObj)\ CONST}
\DoxyCodeLine{00191\ \ \ \ \ \{}
\DoxyCodeLine{00192\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ this-\/>\mbox{\hyperlink{class_smart_pointer_a4458f95c33d46be35a4ce0d3ed21be8d}{QueryInterface}}(\_\_uuidof(otherComClass),\ destObj);}
\DoxyCodeLine{00193\ \ \ \ \ \}}
\DoxyCodeLine{00194\ }
\DoxyCodeLine{00201\ \ \ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ otherComClass>}
\DoxyCodeLine{00202\ \ \ \ \ \mbox{\hyperlink{class_smart_pointer}{SmartPointer<otherComClass>}}\ \mbox{\hyperlink{class_smart_pointer_a698ca40a80fd57a62e769371505f2c78}{getInterface}}()\ CONST}
\DoxyCodeLine{00203\ \ \ \ \ \{}
\DoxyCodeLine{00204\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_smart_pointer}{SmartPointer<otherComClass>}}\ destObj;}
\DoxyCodeLine{00205\ }
\DoxyCodeLine{00206\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{class_smart_pointer_a4458f95c33d46be35a4ce0d3ed21be8d}{QueryInterface}}(destObj)\ ==\ S\_OK)}
\DoxyCodeLine{00207\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ destObj;}
\DoxyCodeLine{00208\ }
\DoxyCodeLine{00209\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00210\ \ \ \ \ \}}
\DoxyCodeLine{00211\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00212\ }
\DoxyCodeLine{00218\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_smart_pointer_a2bfb0ebe9f8d89c4c3158e752e66737f}{release}}()}
\DoxyCodeLine{00219\ \ \ \ \ \{}
\DoxyCodeLine{00220\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{class_smart_pointer_aac6766043d71d6919260b32e3025f5ad}{ptr}}\ !=\ \textcolor{keyword}{nullptr})\ \mbox{\hyperlink{class_smart_pointer_aac6766043d71d6919260b32e3025f5ad}{ptr}}-\/>Release();}
\DoxyCodeLine{00221\ \ \ \ \ \}}
\DoxyCodeLine{00222\ }
\DoxyCodeLine{00228\ \ \ \ \ ComClass**\ \mbox{\hyperlink{class_smart_pointer_a9e700118998b3b6740c5cadbc38123d2}{operator\&}}()\ noexcept\ \{\textcolor{comment}{/*\ (innaccessible)\ */}\}}
\DoxyCodeLine{00229\ }
\DoxyCodeLine{00231\ \ \ \ \ ComClass*\ \mbox{\hyperlink{class_smart_pointer_aac6766043d71d6919260b32e3025f5ad}{ptr}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00232\ \};}
\DoxyCodeLine{00233\ }
\DoxyCodeLine{00240\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class\ }First,\ \textcolor{keyword}{class}...\ ComClasses>}
\DoxyCodeLine{00241\ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_smart_pointer_helper_base}{SmartPointerHelperBase}}\ :\ \textcolor{keyword}{public}\ First,\ \textcolor{keyword}{public}\ ComClasses...}
\DoxyCodeLine{00242\ \{}
\DoxyCodeLine{00243\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00249\ \ \ \ \ \mbox{\hyperlink{class_smart_pointer_helper_base_ac76861e9458ab17c981b2b76f5890321}{SmartPointerHelperBase}}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ initRef)\ :\ \mbox{\hyperlink{class_smart_pointer_helper_base_ad2bc91bd39ccd269a3eec9cdcce0f8cf}{refCount}}(initRef)\ \{\}}
\DoxyCodeLine{00254\ \ \ \ \ \textcolor{keyword}{virtual}\ \mbox{\hyperlink{class_smart_pointer_helper_base_aef037e04d1a2ee08824b405b077d4b09}{\string~SmartPointerHelperBase}}()\ =\ \textcolor{keywordflow}{default};}
\DoxyCodeLine{00255\ }
\DoxyCodeLine{00261\ \ \ \ \ ULONG\ STDMETHODCALLTYPE\ \mbox{\hyperlink{class_smart_pointer_helper_base_a2c9426410eeb136beba8123b5d84dc6e}{AddRef}}()}
\DoxyCodeLine{00262\ \ \ \ \ \{}
\DoxyCodeLine{00263\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ ++\mbox{\hyperlink{class_smart_pointer_helper_base_ad2bc91bd39ccd269a3eec9cdcce0f8cf}{refCount}};}
\DoxyCodeLine{00264\ \ \ \ \ \}}
\DoxyCodeLine{00270\ \ \ \ \ ULONG\ STDMETHODCALLTYPE\ \mbox{\hyperlink{class_smart_pointer_helper_base_a3d16d242d337b87ad0a447ce8d6a7ecb}{Release}}()}
\DoxyCodeLine{00271\ \ \ \ \ \{}
\DoxyCodeLine{00272\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ r\ =\ -\/-\/\mbox{\hyperlink{class_smart_pointer_helper_base_ad2bc91bd39ccd269a3eec9cdcce0f8cf}{refCount}};}
\DoxyCodeLine{00273\ }
\DoxyCodeLine{00274\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (r\ ==\ 0)}
\DoxyCodeLine{00275\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{delete}\ \textcolor{keyword}{this};}
\DoxyCodeLine{00276\ }
\DoxyCodeLine{00277\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ r;}
\DoxyCodeLine{00278\ \ \ \ \ \}}
\DoxyCodeLine{00279\ }
\DoxyCodeLine{00280\ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00281\ }
\DoxyCodeLine{00286\ \ \ \ \ ULONG\ \mbox{\hyperlink{class_smart_pointer_helper_base_ad2bc91bd39ccd269a3eec9cdcce0f8cf}{refCount}};}
\DoxyCodeLine{00287\ }
\DoxyCodeLine{00298\ \ \ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ Type>}
\DoxyCodeLine{00299\ \ \ \ \ HRESULT\ STDMETHODCALLTYPE\ \mbox{\hyperlink{class_smart_pointer_helper_base_accdc2a95363ae4f3e76d5dc00e8fef38}{castToType}}(\textcolor{keywordtype}{void}**\ result)}
\DoxyCodeLine{00300\ \ \ \ \ \{}
\DoxyCodeLine{00301\ \ \ \ \ \ \ \ \ this-\/>\mbox{\hyperlink{class_smart_pointer_helper_base_a2c9426410eeb136beba8123b5d84dc6e}{AddRef}}();}
\DoxyCodeLine{00302\ \ \ \ \ \ \ \ \ *result\ =\ \textcolor{keyword}{dynamic\_cast<}Type*\textcolor{keyword}{>}(\textcolor{keyword}{this});}
\DoxyCodeLine{00303\ }
\DoxyCodeLine{00304\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ S\_OK;}
\DoxyCodeLine{00305\ \ \ \ \ \}}
\DoxyCodeLine{00306\ }
\DoxyCodeLine{00314\ \ \ \ \ HRESULT\ STDMETHODCALLTYPE\ \mbox{\hyperlink{class_smart_pointer_helper_base_af53910e1f9f795cd1016ff8cef9798af}{QueryInterface}}(REFIID\ refId,\ \textcolor{keywordtype}{void}**\ result)}
\DoxyCodeLine{00315\ \ \ \ \ \{}
\DoxyCodeLine{00316\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (refId\ ==\ \_\_uuidof\ (IUnknown))}
\DoxyCodeLine{00317\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ castToType<First>\ (result);}
\DoxyCodeLine{00318\ }
\DoxyCodeLine{00319\ \ \ \ \ \ \ \ \ *result\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00320\ }
\DoxyCodeLine{00321\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ E\_NOINTERFACE;}
\DoxyCodeLine{00322\ \ \ \ \ \}}
\DoxyCodeLine{00323\ \};}
\DoxyCodeLine{00324\ }
\DoxyCodeLine{00330\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}...\ ComClasses>}
\DoxyCodeLine{00331\ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_smart_pointer_helper}{SmartPointerHelper}}\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{class_smart_pointer_helper_base}{SmartPointerHelperBase}}<ComClasses...>}
\DoxyCodeLine{00332\ \{}
\DoxyCodeLine{00333\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00339\ \ \ \ \ \textcolor{keyword}{explicit}\ \mbox{\hyperlink{class_smart_pointer_helper_aa049cb2ece5d84617e0c37f885ea4f62}{SmartPointerHelper}}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ initRef\ =\ 1)\ :\ \mbox{\hyperlink{class_smart_pointer_helper_base}{SmartPointerHelperBase}}<ComClasses...>(initRef)\ \{\}}
\DoxyCodeLine{00340\ }
\DoxyCodeLine{00348\ \ \ \ \ HRESULT\ STDMETHODCALLTYPE\ \mbox{\hyperlink{class_smart_pointer_helper_ac41955be7a9eddf7a087305d7e20f08a}{QueryInterface}}(REFIID\ refId,\ \textcolor{keywordtype}{void}**\ result)}
\DoxyCodeLine{00349\ \ \ \ \ \{}
\DoxyCodeLine{00350\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::tuple<IID,\ void*>\ bases[]}
\DoxyCodeLine{00351\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00352\ \ \ \ \ \ \ \ \ \ \ \ \ std::make\_tuple\ (\_\_uuidof(ComClasses),\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{void}*\textcolor{keyword}{>}\ (\textcolor{keyword}{static\_cast<}ComClasses*\textcolor{keyword}{>}\ (\textcolor{keyword}{this})))...}
\DoxyCodeLine{00353\ \ \ \ \ \ \ \ \ \};}
\DoxyCodeLine{00354\ }
\DoxyCodeLine{00355\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Query\ a\ ranged\ 'for'\ loop\ (each\ 'base'\ in\ the\ 'bases'\ tuple\ array)}}
\DoxyCodeLine{00356\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ base\ :\ bases)}
\DoxyCodeLine{00357\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00358\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (refId\ ==\ std::get<0>\ (base))}
\DoxyCodeLine{00359\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00360\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>\mbox{\hyperlink{class_smart_pointer_helper_base_a2c9426410eeb136beba8123b5d84dc6e}{AddRef}}();}
\DoxyCodeLine{00361\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *result\ =\ std::get<1>\ (base);}
\DoxyCodeLine{00362\ }
\DoxyCodeLine{00363\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ S\_OK;}
\DoxyCodeLine{00364\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00365\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00366\ }
\DoxyCodeLine{00367\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{class_smart_pointer_helper_base_af53910e1f9f795cd1016ff8cef9798af}{SmartPointerHelperBase<ComClasses...>::QueryInterface}}\ (refId,\ result);}
\DoxyCodeLine{00368\ \ \ \ \ \}}
\DoxyCodeLine{00369\ \};}
\DoxyCodeLine{00370\ }
\DoxyCodeLine{00378\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ ComClass>}
\DoxyCodeLine{00379\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{win32___smart_pointer_8hpp_a53522409e1312cfaf53cebc29bff8008}{SafeRelease}}(ComClass**\ ptr)}
\DoxyCodeLine{00380\ \{}
\DoxyCodeLine{00381\ \ \ \ \ \textcolor{keywordflow}{if}\ (*ptr)}
\DoxyCodeLine{00382\ \ \ \ \ \{}
\DoxyCodeLine{00383\ \ \ \ \ \ \ \ \ (*ptr)-\/>Release();}
\DoxyCodeLine{00384\ \ \ \ \ \ \ \ \ *ptr\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00385\ \ \ \ \ \}}
\DoxyCodeLine{00386\ \}}

\end{DoxyCode}
